/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/rem@0.7.0-3/src/rem.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function callable(t){var e=function(){return e.call.apply(e,arguments)};return e.__proto__=t,e}function clone(t){return JSON.parse(JSON.stringify(t))}function augment(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&null!=e[n]&&(t[n]=e[n]);return t}function safeJSONStringify(t){return JSON.stringify(t).replace(/[\u007f-\uffff]/g,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))}var Middleware=function(){function t(){}return t.prototype.use=function(t){return(this._middleware||(this._middleware=[])).push(t),this},t.prototype.middleware=function(){var t=Array.prototype.slice.call(arguments),e=t.pop(),n=(this._middleware||[]).slice();return function i(){0==n.length?env.nextTick(e):n.shift().apply(this,t.concat([i.bind(this)]))}.call(this),this},t}(),envtype="undefined"!=typeof module&&module.exports?"node":"browser";if("node"==envtype)var env=require("./node/env");var rem="node"==envtype?exports:this.rem={};function QueueStream(){this._buffer=[],this.readable=this.writable=this.paused=!0,this.ended=this.endedEmitted=this.cache=!1,this.index=0}function CrossStream(){this.input=new QueueStream,this.writable=!0,this.output=new QueueStream,this.readable=!0,["error","close","drain","pipe"].forEach(function(t){this.on(t,this.input.emit.bind(this.input,t))}.bind(this)),["write","end"].forEach(function(t){this[t]=this.input[t].bind(this.input)}.bind(this)),["error","close","data","end"].forEach(function(t){this.output.on(t,this.emit.bind(this,t))}.bind(this)),["pause","resume","pipe"].forEach(function(t){this[t]=this.output[t].bind(this.output)}.bind(this))}function URL(t){this.protocol=void 0,this.auth=void 0,this.hostname=void 0,this.port=void 0,this.pathname=void 0,this.query={},this.hash=void 0,t&&this.parse(t)}function ClientRequest(){this.method="GET",this.headers={},this.url=new URL,this.body=null}rem.userAgent="Mozilla/5.0 (compatible; REMbot/1.0; +http://remlib.org/)",rem.env=env,env.inherits(QueueStream,env.Stream),QueueStream.prototype.pause=function(){this.paused=!0},QueueStream.prototype.resume=function(){for(this.paused=!1;this.index<this._buffer.length;)this.emit("data",this._buffer[this.index++]);this.cache||(this._buffer=[],this.index=0),this.ended&&!this.endedEmitted&&this.end()},QueueStream.prototype.write=function(t){return this._buffer.push(t),this.paused||this.emit("data",this.cache?t:this._buffer.pop()),!0},QueueStream.prototype.end=function(t){t&&this.write(t),this.ended=!0,this.paused||(this.emit("end"),this.endedEmitted=!0)},QueueStream.prototype.toBuffer=function(){return env.concatList(this._buffer)},env.inherits(CrossStream,env.EventEmitter),rem.serializer={json:function(t){return safeJSONStringify(t)},form:function(t){return env.qs.stringify(t)}},rem.parsers={stream:function(t,e){e(null,t)},binary:function(t,e){env.consumeStream(t,(function(t){e(null,t)}))},text:function(t,e){env.consumeStream(t,(function(t){e(null,String(t).replace(/^\uFEFF/,""))}))},json:function(t,e){rem.parsers.text(t,(function(t,n){if(t||!n.length)return e(t);try{var i=JSON.parse(String(n))}catch(i){return(t=new SyntaxError("Could not parse JSON response: "+i.message+"\n"+n)).stack=i.stack,e(t,null)}e(null,i)}))},xml:function(t,e){rem.parsers.text(t,(function(t,n){if(t||!n.length)return e(t);var i=!1;try{env.parseXML(n,(function(t){i=!0,e(null,t)}))}catch(r){if(i)throw r;(t=new SyntaxError("Could not parse XML response: "+r.message+"\n"+n)).stack=r.stack,e(t,null)}}))}},rem.URL=URL,URL.prototype.getHost=function(){return this.hostname&&this.hostname+(this.port?":"+this.port:"")},URL.prototype.getPath=function(){return this.pathname+(env.qs.stringify(this.query)?"?"+env.qs.stringify(this.query):"")+(this.hash?"#"+encodeURIComponent(this.hash):"")},URL.prototype.toString=function(){return env.formatURL(this)},URL.prototype.augment=function(t){this.protocol=t.protocol||this.protocol,this.auth=t.auth||this.auth,this.hostname=t.hostname||this.hostname,this.port=t.port||this.port,this.pathname=t.pathname||this.pathname,augment(this.query,t.query),this.hash=t.hash||this.hash},URL.prototype.parse=function(t){this.augment(env.parseURL(t))},rem.ClientRequest=ClientRequest,ClientRequest.prototype.setHeader=function(t,e){this.headers[String(t).toLowerCase()]=e},ClientRequest.prototype.getHeader=function(t){return this.headers[String(t).toLowerCase()]},ClientRequest.prototype.removeHeader=function(t){return delete this.headers[String(t).toLowerCase()]},ClientRequest.prototype.setBody=function(t,e){"object"!=typeof e||env.isList(e)||("form"!=t&&"application/x-www-form-urlencoded"!=t||(t="application/x-www-form-urlencoded",e=rem.serializer.form(e)),"json"!=t&&"application/json"!=t||(t="application/json",e=rem.serializer.json(e))),this.setHeader("Content-Length",e.length),this.setHeader("Content-Type",t),this.body=e},ClientRequest.prototype.send=function(t,e){return env.sendRequest(this,t,e)},ClientRequest.prototype.awaitingStream=function(){return!this.body&&-1!=["PUT","POST","PATCH"].indexOf(this.method)};var Route=function(){function t(t,e,n,i){this.url=t,this.defaultBodyMime=e||"json",this.callback=i,this.redirect=n,this.routeMiddleware=function(t,e){e()}}return t.prototype.use=function(t){var e=this.routeMiddleware;return this.routeMiddleware=function(n,i){e(n,(function(){t(n,i)}))},this},t.prototype.headers=function(t){return this.use((function(e,n){for(var i in t)e.headers[i]=t[i];n()}))},[["get","GET"],["head","HEAD"],["del","DELETE"]].forEach((function(e){var n=e[0],i=e[1];t.prototype[n]=function(t,e){"function"==typeof t&&(e=t,t=null);var n=new ClientRequest;return n.url.augment(this.url),n.method=i,n.redirect=this.redirect,augment(n.url.query,t||{}),this.callback(n,this.routeMiddleware,e)}})),[["post","POST"],["put","PUT"],["patch","PATCH"]].forEach((function(e){var n=e[0],i=e[1];t.prototype[n]=function(t,e,n,r){var s,o,a,u,h=Array.prototype.slice.call(arguments);"function"==typeof h[h.length-1]&&(u=h.pop()),h.length>=2&&"object"==typeof h[0]&&(s=h.shift()),2==h.length&&(o=h.shift()),a=h.shift();var p=new ClientRequest;return p.url.augment(this.url),p.method=i,p._explicitMime=null!=o,p.method=i,augment(p.url.query,s||{}),a&&p.setBody(o||this.defaultBodyMime,a),this.callback(p,this.routeMiddleware,u)}})),t}(),Client=function(){function t(t){this.parsers={},Object.keys(rem.parsers).forEach(function(t){this.parsers[t]=rem.parsers[t],this[t]=function(){return this._request.bind(this,t).apply(this,arguments)}}.bind(this)),this.options={format:"json",redirect:!0},t&&this.configure(t),this.use((function(t,e){t.headers["user-agent"]=t.headers["user-agent"]||rem.userAgent,e()}))}return env.inherits(t,Middleware),t.prototype.configure=function(t){return augment(this.options,t),this},t.prototype._request=function(t){var e=Array.prototype.slice.call(arguments,1),n="object"==typeof e[e.length-1]?e.pop():{},i=(-1!=(e[0]||"").indexOf("//")?e.shift():e.length?"/":"")+(e.length?env.joinPath.apply(null,e.map(String)):"");return augment((i=new URL(i)).query,n),new Route(i,this.options.uploadFormat,this.options.redirect,function(e,n,i){var r=new CrossStream;function s(){e.body&&!e._explicitMime&&(e.setHeader("Content-Type",e.body),e.removeHeader("Content-Length"),e.body=null)}return r.once("pipe",s),env.nextTick(r.removeListener.bind(r,"pipe",s)),this.middleware(e,function(){n(e,function(){this.debug&&console.error(String(e.method).green,String(e.url).grey,e.body?("[body: "+(e.body.length?e.body.length+" bytes":"stream")+"]").grey:""),this.send(e,r,function(t,e){return function(n,i){t.debug&&(i?console.error(String(i.statusCode).green,("[type: "+String(i.headers["content-type"])+"]").grey,("[body: "+String(i.headers["content-length"])+"]").grey):console.error("ERROR".green,String(n).grey)),e.apply(this,arguments)}}(this,function(e,n){r.output.resume(),n.pipe(r.output),r.emit("response",n),this.parsers[t](n,(function(t,e){var s=t||(n.statusCode>=400?n.statusCode:0);i&&i.call(this,s,e,n),r.emit("return",s,e,n)}))}.bind(this)))}.bind(this))}.bind(this)),r}.bind(this))},t.prototype.call=function(){return this._request.bind(this,this.options.format).apply(this,arguments)},t.prototype.send=function(t,e,n){var i=t.send(this.agent,n);t.awaitingStream()?(e.input.pipe(i),e.input.resume()):(null!=t.body&&i.write(t.body),i.end())},t.prototype.throttle=function(t){if(null==t)return this.send=this._send||this.send,this;var e=[];return setInterval((function(){var t=e.shift();t&&t()}),Math.floor(1e3/t)),this._send||(this._send=this.send),this.send=function(){var t=arguments;e.push(function(){this._send.apply(this,t)}.bind(this))},this},t}(),ManifestClient=function(){function t(t,e){this.manifest=t,this.manifest.configuration=this.manifest.configuration||["key","secret"],Client.call(this,e),this.use(function(t,e){if(this.manifest.base){var n=t.url.pathname.replace(/^(?!\/)/,"/");if(env.isList(this.manifest.base)){var i="";this.manifest.base.some((function(t){if(n.match(new RegExp(t[0])))return i=t[1],!0}))}else i=String(this.manifest.base);if(i&&(t.url.protocol||t.url.hostname)&&env.formatURL({protocol:t.url.protocol,hostname:t.url.hostname})!=i.replace(/\/+$/,""))throw new Error("Full request URL ("+String(t.url)+") does not match API base URL ("+i+")");t.url.augment(new URL(i)),t.url.pathname=env.joinPath(t.url.pathname,n)}if(this.manifest.basepath&&(t.url.pathname=this.manifest.basepath+t.url.pathname),this.manifest.suffix&&(t.url.pathname+=this.manifest.suffix),this.manifest.configParams){var r=this.manifest.configParams;for(var s in r)t.url.query[s]=this.options[this.manifest.configParams[s]]}if(this.manifest.params){r=this.manifest.params;for(var s in r)t.url.query[s]=r[s]}e()}.bind(this))}return env.inherits(t,Client),t.prototype.configure=function(t){if(augment(this.options,t),this.manifest.formats){if(!this.manifest.formats[this.options.format])throw new Error('Format "'+this.options.format+'" is not explicitly defined in this manifest. Please specify an available format this API supports.');augment(this.manifest,this.manifest.formats[this.options.format])}return this.options.uploadFormat=this.options.uploadFormat||this.manifest.uploadFormat,this},t.prototype.promptAuthentication=function(t,e){return e||(e=t,t={}),env.promptAuthentication(rem,this,t,e),this},t.prototype.promptConfiguration=function(t){return env.promptConfiguration(rem,this,t),this},t.prototype.prompt=function(t,e){return e||(e=t,t={}),this.promptConfiguration(function(){this.promptAuthentication(t,(function(){console.error(""),e.apply(this,arguments)}))}.bind(this)),this},t}();function createFromManifest(t,e,n,i){if(n=n=Number(n)||"*",!t||!t[n]){if("*"!=n||!t)throw t?new Error("Unable to find API "+JSON.stringify(e)+" version "+JSON.stringify(Number(n))+'. For the latest API, use "*".'):new Error("Unable to find API "+JSON.stringify(e)+".");if(!t[n=Object.keys(t).sort().pop()])throw new Error("Unable to find API "+JSON.stringify(e)+" version "+JSON.stringify(Number(n))+'. For the latest API, use "*".')}return(t=t[n]).version=n,rem.createClient(t).configure(i)}rem.Client=Client,rem.ManifestClient=ManifestClient,rem.createClient=function(t,e){"string"==typeof t&&(t={base:t});var n=callable(new ManifestClient(t,e));return rem.env.oncreate(n),n},rem.connect=function(t,e,n){return createFromManifest(env.lookupManifestSync(t),t,e,n)},rem.connectAsync=function(t,e,n,i){i||(i=n,n={}),env.lookupManifest(t,(function(r,s){r?i(r):i(null,createFromManifest(s,t,e,n))}))};var defaultClient=new rem.Client;Object.keys(rem.parsers).forEach((function(t){rem[t]=function(){return defaultClient[t].apply(defaultClient,arguments)}})),"node"==envtype&&(require("./node/oauth"),require("./node/basic"));
//# sourceMappingURL=/sm/654bfccf1defe352139ab880ea0f9c439680446e3c3b7e742d907b2ac001b0c9.map